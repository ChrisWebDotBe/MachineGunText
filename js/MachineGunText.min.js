(function(e){e.fn.MachineGunText=function(t){var n={width:"100%",height:"50px",bgcolor:"#000",bgimage:"",bgrepeat:"no-repeat",bgposition:"top center",bgattachment:"fixed",bgsize:"cover",text:"don't forget to set text",maxlenght:12,fontcolor:"#fff",fontsize:"50px",fontfamily:"Arial",fontweight:"400",animsentencemaxduration:.5,animdelay:.6,animrepeat:-1,animrepeatdelay:2,animdramaticpause:true,animdramaticpauseduration:.6,animmaxscale:1.2,callback:null,callbacksentence:null};var r=e.extend(n,t);var i=(parseInt(r.height)-parseInt(r.fontsize))/2+"px";this.each(function(){function o(e,t){if(t===undefined){return e.split(" ")}var n=e.split(" "),r=n.length,i=[],o=[],u;for(u=0;u<r;u++){i.push(n[u]);if(s.test(n[u])||u===r-1||i.join(" ").length+n[u+1].length>t){o.push(i.join(" "));i=[]}}return o}function u(t,u){if(!(t instanceof Array)){t=o(t,u)}var a=new TimelineMax({delay:r.animdelay,onComplete:function(){if(r.callback){r.callback()}},repeat:r.animrepeat,repeatDelay:r.animrepeatdelay}),f=0,l,c,h,p,d;for(d=0;d<t.length;d++){l=t[d];p=s.test(l)||d===t.length-1;c=e("<div>"+l+"</div>").css({position:"absolute",margin:"0",padding:"0",top:i,"text-align":"center",visibility:"hidden",width:r.width,color:r.fontcolor,fontFamily:r.fontfamily,fontWeight:r.fontweight,fontSize:r.fontsize}).addClass("MachineGunTextSentence").appendTo(n);h=Math.max(r.animsentencemaxduration,l.length*.08);if(p){h+=r.animdramaticpause==true?r.animdramaticpauseduration:0}TweenLite.set(c,{autoAlpha:0,scale:0,z:.01});a.to(c,h,{scale:r.animmaxscale,ease:SlowMo.ease.config(.25,.9)},f).to(c,h,{autoAlpha:1,ease:SlowMo.ease.config(.25,.9,true),onComplete:function(){if(r.callbacksentence){r.callbacksentence()}}},f);f+=h-.05;if(p){f+=r.animdramaticpause==true?r.animdramaticpauseduration:0}}}var t=e(this);t.css({position:"relative",marginLeft:"auto",marginRight:"auto",overflow:"hidden",width:r.width,height:r.height,background:r.bgcolor});if(r.bgimage!=""){t.css({background:"url("+r.bgimage+")","background-repeat":r.bgrepeat,"background-position":r.bgposition,"background-attachment":r.bgattachment,"-webkit-background-size":r.bgsize,"-moz-background-size":r.bgsize,"-o-background-size":r.bgsize,"background-size":r.bgsize})}t.addClass("MachineGunTextContainer");var n=t,s=/(\.|\?|!)$/g;u(r.text,r.maxlenght)});return this}})(jQuery)
